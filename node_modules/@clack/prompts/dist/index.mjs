import{TextPrompt as E,ConfirmPrompt as T,SelectPrompt as w,MultiSelectPrompt as R,block as O,isCancel as A}from"@clack/core";export{isCancel}from"@clack/core";import u from"node:process";import e from"picocolors";import{cursor as f,erase as B}from"sisteransi";function I(){return u.platform!=="win32"?u.env.TERM!=="linux":Boolean(u.env.CI)||Boolean(u.env.WT_SESSION)||Boolean(u.env.TERMINUS_SUBLIME)||u.env.ConEmuTask==="{cmd::Cmder}"||u.env.TERM_PROGRAM==="Terminus-Sublime"||u.env.TERM_PROGRAM==="vscode"||u.env.TERM==="xterm-256color"||u.env.TERM==="alacritty"||u.env.TERMINAL_EMULATOR==="JetBrains-JediTerm"}const m=I(),l=(t,i)=>m?t:i,V=l("\u25C6","*"),b=l("\u25A0","x"),M=l("\u25B2","x"),h=l("\u25C7","o"),N=l("\u250C","T"),c=l("\u2502","|"),$=l("\u2514","\u2014"),g=l("\u25CF",">"),y=l("\u25CB"," "),P=l("\u25FB","[\u2022]"),_=l("\u25FC","[+]"),x=l("\u25FB","[ ]"),S=l("\u2500","-"),j=l("\u256E","+"),k=l("\u251C","+"),D=l("\u256F","+"),d=t=>{switch(t){case"initial":case"active":return e.cyan(V);case"cancel":return e.red(b);case"error":return e.yellow(M);case"submit":return e.green(h)}},H=t=>new E({validate:t.validate,placeholder:t.placeholder,defaultValue:t.defaultValue,initialValue:t.initialValue,render(){const i=`${e.gray(c)}
${d(this.state)}  ${t.message}
`,s=t.placeholder?e.inverse(t.placeholder[0])+e.dim(t.placeholder.slice(1)):e.inverse(e.hidden("_")),n=this.value?this.valueWithCursor:s;switch(this.state){case"error":return`${i.trim()}
${e.yellow(c)}  ${n}
${e.yellow($)}  ${e.yellow(this.error)}
`;case"submit":return`${i}${e.gray(c)}  ${e.dim(this.value||t.placeholder)}`;case"cancel":return`${i}${e.gray(c)}  ${e.strikethrough(e.dim(this.value??""))}${this.value?.trim()?`
`+e.gray(c):""}`;default:return`${i}${e.cyan(c)}  ${n}
${e.cyan($)}
`}}}).prompt(),F=t=>{const i=t.active??"Yes",s=t.inactive??"No";return new T({active:i,inactive:s,initialValue:t.initialValue??!0,render(){const n=`${e.gray(c)}
${d(this.state)}  ${t.message}
`,r=this.value?i:s;switch(this.state){case"submit":return`${n}${e.gray(c)}  ${e.dim(r)}`;case"cancel":return`${n}${e.gray(c)}  ${e.strikethrough(e.dim(r))}
${e.gray(c)}`;default:return`${n}${e.cyan(c)}  ${this.value?`${e.green(g)} ${i}`:`${e.dim(y)} ${e.dim(i)}`} ${e.dim("/")} ${this.value?`${e.dim(y)} ${e.dim(s)}`:`${e.green(g)} ${s}`}
${e.cyan($)}
`}}}).prompt()},L=t=>{const i=(s,n)=>{const r=s.label??String(s.value);return n==="active"?`${e.green(g)} ${r} ${s.hint?e.dim(`(${s.hint})`):""}`:n==="selected"?`${e.dim(r)}`:n==="cancelled"?`${e.strikethrough(e.dim(r))}`:`${e.dim(y)} ${e.dim(r)}`};return new w({options:t.options,initialValue:t.initialValue,render(){const s=`${e.gray(c)}
${d(this.state)}  ${t.message}
`;switch(this.state){case"submit":return`${s}${e.gray(c)}  ${i(this.options[this.cursor],"selected")}`;case"cancel":return`${s}${e.gray(c)}  ${i(this.options[this.cursor],"cancelled")}
${e.gray(c)}`;default:return`${s}${e.cyan(c)}  ${this.options.map((n,r)=>i(n,r===this.cursor?"active":"inactive")).join(`
${e.cyan(c)}  `)}
${e.cyan($)}
`}}}).prompt()},U=t=>{const i=(s,n)=>{const r=s.label??String(s.value);return n==="active"?`${e.cyan(P)} ${r} ${s.hint?e.dim(`(${s.hint})`):""}`:n==="selected"?`${e.green(_)} ${e.dim(r)}`:n==="cancelled"?`${e.strikethrough(e.dim(r))}`:n==="active-selected"?`${e.green(_)} ${r} ${s.hint?e.dim(`(${s.hint})`):""}`:n==="submitted"?`${e.dim(r)}`:`${e.dim(x)} ${e.dim(r)}`};return new R({options:t.options,initialValue:t.initialValue,required:t.required??!0,cursorAt:t.cursorAt,render(){let s=`${e.gray(c)}
${d(this.state)}  ${t.message}
`;switch(this.state){case"submit":{const n=this.options.filter(r=>this.selectedValues.some(a=>a===r.value));return`${s}${e.gray(c)}  ${n.map((r,a)=>i(r,"submitted")).join(e.dim(", "))}`}case"cancel":{const r=this.options.filter(a=>this.selectedValues.some(o=>o===a.value)).map((a,o)=>i(a,"cancelled")).join(e.dim(", "));return`${s}${e.gray(c)}  ${r.trim()?`${r}
${e.gray(c)}`:""}`}case"error":{const n=this.error.split(`
`).map((r,a)=>a===0?`${e.yellow($)}  ${e.yellow(r)}`:`   ${r}`).join(`
`);return`${s}${e.yellow(c)}  ${this.options.map((r,a)=>{const o=this.selectedValues.includes(r.value),p=a===this.cursor;return p&&o?i(r,"active-selected"):o?i(r,"selected"):i(r,p?"active":"inactive")}).join(`
${e.yellow(c)}  `)}
${n}
`}default:return`${s}${e.cyan(c)}  ${this.options.map((n,r)=>{const a=this.selectedValues.includes(n.value),o=r===this.cursor;return o&&a?i(n,"active-selected"):a?i(n,"selected"):i(n,o?"active":"inactive")}).join(`
${e.cyan(c)}  `)}
${e.cyan($)}
`}}}).prompt()},C=t=>t.replace(X(),""),G=(t="",i="")=>{const s=`
${t}
`.split(`
`),n=s.reduce((a,o)=>(o=C(o),o.length>a?o.length:a),0)+2,r=s.map(a=>`${e.gray(c)}  ${e.dim(a)}${" ".repeat(n-C(a).length)}${e.gray(c)}`).join(`
`);process.stdout.write(`${e.gray(c)}
${e.green(h)}  ${e.reset(i)} ${e.gray(S.repeat(n-i.length-1)+j)}
${r}
${e.gray(k+S.repeat(n+2)+D)}
`)},Z=(t="")=>{process.stdout.write(`${e.gray($)}  ${e.red(t)}

`)},q=(t="")=>{process.stdout.write(`${e.gray(N)}  ${t}
`)},z=(t="")=>{process.stdout.write(`${e.gray(c)}
${e.gray($)}  ${t}

`)},v=m?["\u25D2","\u25D0","\u25D3","\u25D1"]:["\u2022","o","O","0"],K=()=>{let t,i;const s=m?80:120;return{start(n=""){n=n.replace(/\.?\.?\.$/,""),t=O(),process.stdout.write(`${e.gray(c)}
${e.magenta("\u25CB")}  ${n}
`);let r=0,a=0;i=setInterval(()=>{let o=v[r];process.stdout.write(f.move(-999,-1)),process.stdout.write(`${e.magenta(o)}  ${n}${Math.floor(a)>=1?".".repeat(Math.floor(a)).slice(0,3):""}   
`),r=r===v.length-1?0:r+1,a=a===v.length?0:a+.125},s)},stop(n=""){process.stdout.write(f.move(-999,-2)),process.stdout.write(B.down(2)),clearInterval(i),process.stdout.write(`${e.gray(c)}
${e.green(h)}  ${n}
`),t()}}};function X(){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(t,"g")}const J=async(t,i)=>{const s={},n=Object.keys(t);for(const r of n){const a=await t[r]({results:s}).catch(o=>{throw o});if(typeof i?.onCancel=="function"&&A(a)){s[r]="canceled",i.onCancel({results:s});continue}s[r]=a}return s};export{Z as cancel,F as confirm,J as group,q as intro,U as multiselect,G as note,z as outro,L as select,K as spinner,H as text};
